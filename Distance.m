function [dis] = Distance(x,y,a,n)%y:normalized data     n:symbol size     a:alphabet size  
%here a=2   b=2 etc...
Breakpoint=[-0.43,-0.67,-0.84,-0.97,-1.07,-1.15,-1.22,-1.28;...
             0.43,0,    -0.25,-0.43,-0.57,-0.67,-0.76,-0.84;...
             -1,  0.67, 0.25, 0,    -1.18,-0.32,-0.43,-0.52;...
             -1,  -1,   0.84, 0.43, 0.18, 0,    -0.14,-0.25;...
             -1,  -1,   -1,   0.97, 0.57, 0.32, 0.14, 0;...
             -1,  -1,   -1,   -1,   1.07, 0.67, 0.43, 0.25;...
             -1,  -1,   -1,   -1,   -1,   1.15, 0.76, 0.52;...
             -1,  -1,   -1,   -1,   -1,   -1,   1.12, 0.84;...
             -1,  -1,   -1,   -1,   -1,   -1,   -1,   1.28;];%a = 3-10    
% Cell  = zeros(a,a);
% for i = 1:a
%     for j = 1:a
%         if abs(i-j)<=1
%             Cell(i,j)=0;
%         else
%             Cell(i,j)=Breakpoint(max([i,j]-1),a-2)-Breakpoint(min([i,j]),a-2);
%         end
%     end
% end%放外面省的算
if a == 3
    Cell = [0,0,0.8600;0,0,0;0.8600,0,0];
elseif a == 4
    Cell = [         0         0    0.6700    1.3400
                     0         0         0    0.6700
                0.6700         0         0         0
                1.3400    0.6700         0         0];
elseif a == 5
    Cell = [         0         0    0.5900    1.0900    1.6800
                     0         0         0    0.5000    1.0900
                0.5900         0         0         0    0.5900
                1.0900    0.5000         0         0         0
                1.6800    1.0900    0.5900         0         0];
elseif a == 6
    Cell = [         0         0    0.5400    0.9700    1.4000    1.9400
                     0         0         0    0.4300    0.8600    1.4000
                0.5400         0         0         0    0.4300    0.9700
                0.9700    0.4300         0         0         0    0.5400
                1.4000    0.8600    0.4300         0         0         0
                1.9400    1.4000    0.9700    0.5400         0         0];
elseif a == 7
    Cell = [         0         0    0.5000   -0.1100    1.2500    1.6400    2.1400
                     0         0         0   -0.6100    0.7500    1.1400    1.6400
                0.5000         0         0         0    1.3600    1.7500    2.2500
               -0.1100   -0.6100         0         0         0    0.3900    0.8900
                1.2500    0.7500    1.3600         0         0         0    0.5000
                1.6400    1.1400    1.7500    0.3900         0         0         0
                2.1400    1.6400    2.2500    0.8900    0.5000         0         0];
elseif a == 8
    Cell = [         0         0    0.4800    0.8300    1.1500    1.4700    1.8200    2.3000
                     0         0         0    0.3500    0.6700    0.9900    1.3400    1.8200
                0.4800         0         0         0    0.3200    0.6400    0.9900    1.4700
                0.8300    0.3500         0         0         0    0.3200    0.6700    1.1500
                1.1500    0.6700    0.3200         0         0         0    0.3500    0.8300
                1.4700    0.9900    0.6400    0.3200         0         0         0    0.4800
                1.8200    1.3400    0.9900    0.6700    0.3500         0         0         0
                2.3000    1.8200    1.4700    1.1500    0.8300    0.4800         0         0];
elseif a == 9
    Cell = [         0         0    0.4600    0.7900    1.0800    1.3600    1.6500    1.9800    2.3400
                     0         0         0    0.3300    0.6200    0.9000    1.1900    1.5200    1.8800
                0.4600         0         0         0    0.2900    0.5700    0.8600    1.1900    1.5500
                0.7900    0.3300         0         0         0    0.2800    0.5700    0.9000    1.2600
                1.0800    0.6200    0.2900         0         0         0    0.2900    0.6200    0.9800
                1.3600    0.9000    0.5700    0.2800         0         0         0    0.3300    0.6900
                1.6500    1.1900    0.8600    0.5700    0.2900         0         0         0    0.3600
                1.9800    1.5200    1.1900    0.9000    0.6200    0.3300         0         0         0
                2.3400    1.8800    1.5500    1.2600    0.9800    0.6900    0.3600         0         0];
elseif a == 10
    Cell = [         0         0    0.4400    0.7600    1.0300    1.2800    1.5300    1.8000    2.1200    2.5600
                     0         0         0    0.3200    0.5900    0.8400    1.0900    1.3600    1.6800    2.1200
                0.4400         0         0         0    0.2700    0.5200    0.7700    1.0400    1.3600    1.8000
                0.7600    0.3200         0         0         0    0.2500    0.5000    0.7700    1.0900    1.5300
                1.0300    0.5900    0.2700         0         0         0    0.2500    0.5200    0.8400    1.2800
                1.2800    0.8400    0.5200    0.2500         0         0         0    0.2700    0.5900    1.0300
                1.5300    1.0900    0.7700    0.5000    0.2500         0         0         0    0.3200    0.7600
                1.8000    1.3600    1.0400    0.7700    0.5200    0.2700         0         0         0    0.4400
                2.1200    1.6800    1.3600    1.0900    0.8400    0.5900    0.3200         0         0         0
                2.5600    2.1200    1.8000    1.5300    1.2800    1.0300    0.7600    0.4400         0         0];
end
dis = 0;
for i = 1:length(x)
dis = Cell(x(i),y(i))^2+ dis;
end
dis = sqrt(dis)*sqrt(n);
end